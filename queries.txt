1. Weekly Sales History: Given a specific week, how many orders were published?

SELECT COUNT(*) as orders_count
FROM RECEIPT 
WHERE ORDER_DATE BETWEEN '2025-06-08' AND ('2025-06-08'::date + INTERVAL '6 days');

  2. Realistic Sales History: Given a specific hour of the day, how many orders were placed, and what was the total sum of orders?


PREPARE get_by_hour(int) AS
SELECT
  r.ORDER_TIME AS hours,
  COUNT(o.ORDER_ID) AS items_count,
  SUM(it.PRICE) AS total_revenue
FROM RECEIPT r
JOIN ORDERS o ON o.RECEIPT_ID = r.RECEIPT_ID
JOIN ITEM it  ON it.ITEM_ID = o.ITEM_ID
WHERE r.ORDER_TIME = $1
GROUP BY r.ORDER_TIME;
PREPARE

PREPARE get_by_day_hour(date, int) AS
SELECT
  r.ORDER_DATE AS order_date,
  r.ORDER_TIME AS hours,
  COUNT(o.ORDER_ID) AS items_count,
  SUM(it.PRICE)   AS total_revenue
FROM RECEIPT r
JOIN ORDERS o ON o.RECEIPT_ID = r.RECEIPT_ID
JOIN ITEM it   ON it.ITEM_ID = o.ITEM_ID
WHERE r.ORDER_DATE = $1
  AND r.ORDER_TIME = $2
GROUP BY r.ORDER_DATE, r.ORDER_TIME
ORDER BY r.ORDER_DATE, r.ORDER_TIME;

--run this after the query has been executed
EXECUTE get_by_day_hour('2025-06-11'::date, 19);

3. Peak Sales Day: Given a specific day, what was the sum of the top 10 order totals

4. Menu Item Inventory: Given a specific menu item, how many items from the inventory does that menu item use?

For all items:
SELECT it.ITEM_NAME, COUNT(r.INGREDIENT_ID) AS ingredient_count
FROM ITEM it
JOIN RECIPE r ON it.ITEM_ID = r.ITEM_ID
GROUP BY it.ITEM_NAME;

For a specific item: 
SELECT it.ITEM_NAME, COUNT(r.INGREDIENT_ID) AS ingredient_count
FROM ITEM it
JOIN RECIPE r ON it.ITEM_ID = r.ITEM_ID
WHERE it.ITEM_NAME = 'Wintermelon Milk Tea'
GROUP BY it.ITEM_NAME;

Select ingredients from a specific file:
SELECT ITEM_NAME FROM ITEM;

\prompt 'Select ITEM to see ingredients: '  userINP
SELECT i.INGREDIENT_NAME FROM ITEM it, INGREDIENT i, RECIPE r
WHERE it.ITEM_NAME = :'userINP' AND it.ITEM_ID = r.ITEM_ID AND i.INGREDIENT_ID = r.INGREDIENT_ID; 


Peak Sales Day: Top 10 Orders:
SELECT SUM(order_total) AS top_10_order_sum
FROM (
    SELECT r.receipt_id, SUM(i.price) + COALESCE(r.tip,0) AS order_total
    FROM receipt r
    JOIN orders o ON r.receipt_id = o.receipt_id
    JOIN item i ON o.item_id = i.item_id
    WHERE r.order_date = '2025-09-15'
    GROUP BY r.receipt_id
    ORDER BY order_total DESC
    LIMIT 10
) AS top_orders;

8. Customer Information: Given a receipt number, list the customer and their data (David)

SELECT 
    c.CUSTOMER_ID,
    c.FIRST_NAME,
    c.LAST_NAME,
    c.PHONE_NUMBER,
    c.REWARDS_POINTS
FROM CUSTOMER c
JOIN RECEIPT r ON c.CUSTOMER_ID = r.CUSTOMER_ID
WHERE r.RECEIPT_ID = 12345;  -- Replace with your receipt ID

9. Busiest Day: Find the day with the most orders (David)

SELECT 
    ORDER_DATE,
    COUNT(*) as orders_count
FROM RECEIPT 
GROUP BY ORDER_DATE
ORDER BY orders_count DESC
LIMIT 1;
